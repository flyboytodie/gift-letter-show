let gifts=[],currentImageIndex=0,audio=null;function getUrlParams(){let e={},t=window.location.search;return t&&t.substring(1).split("&").forEach(t=>{let[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}),e}async function loadShowData(){try{let e=getUrlParams().id;if(!e){document.body.innerHTML=`
                <div style="text-align: center; margin-top: 100px;">
                    <h1>\u{9519}\u{8BEF}</h1>
                    <p>\u{7F3A}\u{5C11}\u{5C55}\u{793A}ID\u{FF0C}\u{8BF7}\u{901A}\u{8FC7}\u{6B63}\u{786E}\u{7684}\u{94FE}\u{63A5}\u{8BBF}\u{95EE}\u{3002}</p>
                </div>
            `;return}let t=await fetch(`/api/get-show?id=${e}`),n=await t.json();if(n.success){let e=n.data;e.theme&&(document.body.classList.remove("pink","white","blue"),document.body.classList.add(e.theme)),document.title=e.siteTitle,document.getElementById("site-title").textContent=e.siteTitle,document.getElementById("letter-title").textContent=e.letterTitle,document.getElementById("letter-content").innerHTML=e.letterContent,gifts=e.gifts,renderGifts(),e.audioUrl&&((audio=new Howl({src:[e.audioUrl],loop:!0,volume:.5,autoplay:!0})).play(),document.getElementById("play-btn").textContent="ÊöÇÂÅú",e.audioName&&(document.getElementById("music-name").textContent=e.audioName))}else document.body.innerHTML=`
                <div style="text-align: center; margin-top: 100px;">
                    <h1>\u{9519}\u{8BEF}</h1>
                    <p>${n.error||"Ëé∑ÂèñÂ±ïÁ§∫Êï∞ÊçÆÂ§±Ë¥•"}</p>
                </div>
            `}catch(e){console.error("Âä†ËΩΩÊï∞ÊçÆÂ§±Ë¥•:",e),document.body.innerHTML=`
            <div style="text-align: center; margin-top: 100px;">
                <h1>\u{9519}\u{8BEF}</h1>
                <p>\u{52A0}\u{8F7D}\u{6570}\u{636E}\u{5931}\u{8D25}\u{FF0C}\u{8BF7}\u{7A0D}\u{540E}\u{91CD}\u{8BD5}\u{3002}</p>
            </div>
        `}}function renderGifts(){let e=document.getElementById("gift-grid");e.innerHTML="",gifts.forEach((t,n)=>{let i,o=document.createElement("div");o.className="gift-item";let a=document.createElement("div");a.className="gift-media-container","image"===t.type?((i=document.createElement("img")).src=t.url,i.alt="Á§ºÁâ©ÂõæÁâá",i.className="gift-media",i.onclick=function(){openImageModal(n)}):((i=document.createElement("video")).src=t.url,i.className="gift-media",i.onclick=function(){this.play()});let l=document.createElement("div");l.className="gift-note",l.textContent=t.note||"Êó†Â§áÊ≥®",a.appendChild(i),o.appendChild(a),o.appendChild(l),e.appendChild(o)})}function initPage(){initMusicPlayer(),initImageModal(),loadShowData(),initEmojiRain()}function initMusicPlayer(){document.getElementById("play-btn").addEventListener("click",function(){audio&&(audio.playing()?(audio.pause(),this.textContent="Êí≠Êîæ"):(audio.play(),this.textContent="ÊöÇÂÅú"))}),document.getElementById("volume").addEventListener("input",function(){audio&&audio.volume(parseFloat(this.value))})}function initImageModal(){document.querySelector(".close").addEventListener("click",closeImageModal),window.addEventListener("click",function(e){let t=document.getElementById("image-modal");e.target===t&&closeImageModal()})}function openImageModal(e){currentImageIndex=e;let t=gifts[e];"image"===t.type&&(document.getElementById("modal-image").src=t.url,document.getElementById("image-modal").style.display="block")}function closeImageModal(){document.getElementById("image-modal").style.display="none"}function navigateImage(e){let t=gifts.filter(e=>"image"===e.type);if(0===t.length)return;let n=t.findIndex(e=>e.url===gifts[currentImageIndex].url);n=(n+e+t.length)%t.length,openImageModal(gifts.findIndex(e=>e.url===t[n].url))}function initEmojiRain(){let e=document.querySelector(".letter-content"),t=["üòä","ü•∞","ü§©","üåü","üéÄ","üéâ","‚ú®","üíñ","üå∏","ü¶ã","üåà","üíù","üíó","üíì","üíû"];setTimeout(()=>{createEmojiRain(e,t)},500),setInterval(()=>{createEmojiRain(e,t)},2e3)}function createEmojiRain(e,t){if(e.querySelectorAll(".emoji-rain").length>20)return;let n=Math.floor(5*Math.random())+3;for(let i=0;i<n;i++){let n=document.createElement("div");n.className="emoji-rain",n.textContent=t[Math.floor(Math.random()*t.length)];let i=100*Math.random(),o=25*Math.random()+20,a=4*Math.random()+2;n.style.position="absolute",n.style.left=`${i}%`,n.style.top="-30px",n.style.fontSize=`${o}px`,n.style.pointerEvents="none",n.style.zIndex="10",n.style.animation=`emojiFall ${a}s ease-in-out forwards`,e.appendChild(n),setTimeout(()=>{n.remove()},1e3*a)}}window.onload=initPage;
//# sourceMappingURL=show.bda338e4.js.map
