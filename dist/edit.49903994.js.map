{"mappings":"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","sources":["edit.d2ff2034.js","js/edit.js"],"sourcesContent":[null,"// å…¨å±€å˜é‡\r\nlet gifts = [];\r\nlet currentGiftIndex = -1;\r\nlet quill = null;\r\nlet audio = null;\r\nlet audioFile = null;\r\nlet audioUrl = null;\r\nlet cropper = null;\r\nlet currentFile = null;\r\nlet editId = null; // ç¼–è¾‘çŠ¶æ€ID\r\n\r\n// æœåŠ¡å™¨é…ç½®\r\n// æœåŠ¡å™¨åœ°å€\r\nconst SERVER_URL = 'http://localhost:3000';\r\n\r\n// ä»ŽlocalStorageåŠ è½½æ•°æ®\r\nfunction loadFromLocalStorage() {\r\n    const savedData = localStorage.getItem('giftLetterData');\r\n    if (savedData) {\r\n        try {\r\n            const data = JSON.parse(savedData);\r\n            gifts = data.gifts || [];\r\n            audioUrl = data.audioUrl || null;\r\n            \r\n            // æ›´æ–°éŸ³ä¹æ’­æ”¾å™¨UIçŠ¶æ€\r\n            if (audioUrl) {\r\n                // ä¼˜å…ˆä½¿ç”¨ä¿å­˜çš„åŽŸå§‹æ–‡ä»¶å\r\n                const fileName = data.audioName || (() => {\r\n                    // ä»ŽURLä¸­æå–æ–‡ä»¶åä½œä¸ºå¤‡ç”¨\r\n                    const urlParts = audioUrl.split('/');\r\n                    return urlParts[urlParts.length - 1];\r\n                })();\r\n                document.getElementById('music-info').textContent = fileName;\r\n                \r\n                // æ›´æ–°éŸ³ä¹æ–‡ä»¶åæ˜¾ç¤ºå…ƒç´ \r\n                const musicFilenameElement = document.getElementById('music-filename');\r\n                if (musicFilenameElement) {\r\n                    musicFilenameElement.textContent = fileName;\r\n                    musicFilenameElement.style.color = '#666';\r\n                }\r\n                \r\n                // åˆ›å»ºHowlå®žä¾‹\r\n                if (audio) {\r\n                    audio.unload();\r\n                }\r\n                audio = new Howl({\r\n                    src: [audioUrl],\r\n                    loop: true,\r\n                    volume: parseFloat(document.getElementById('volume').value)\r\n                });\r\n            } else {\r\n                document.getElementById('music-info').textContent = 'æœªé€‰æ‹©';\r\n                \r\n                // æ¸…ç©ºéŸ³ä¹æ–‡ä»¶åæ˜¾ç¤ºå…ƒç´ \r\n                const musicFilenameElement = document.getElementById('music-filename');\r\n                if (musicFilenameElement) {\r\n                    musicFilenameElement.textContent = 'æœªé€‰æ‹©';\r\n                    musicFilenameElement.style.color = '#666';\r\n                }\r\n            }\r\n            \r\n            // æ¢å¤ä¸»é¢˜è‰²\r\n            if (data.theme) {\r\n                document.body.classList.remove('pink', 'white', 'blue');\r\n                document.body.classList.add(data.theme);\r\n                \r\n                // æ›´æ–°é¢œè‰²æŒ‰é’®çŠ¶æ€\r\n                const colorBtns = document.querySelectorAll('.color-btn');\r\n                colorBtns.forEach(btn => {\r\n                    if (btn.dataset.color === data.theme) {\r\n                        btn.classList.add('active');\r\n                    } else {\r\n                        btn.classList.remove('active');\r\n                    }\r\n                });\r\n            }\r\n            \r\n            // æ¢å¤æ ‡é¢˜\r\n            if (data.siteTitle) {\r\n                document.getElementById('site-title').value = data.siteTitle;\r\n            }\r\n            if (data.letterTitle) {\r\n                document.getElementById('letter-title').value = data.letterTitle;\r\n            }\r\n            // æ¢å¤ä¹¦ä¿¡å†…å®¹\r\n            if (data.letterContent && quill) {\r\n                quill.root.innerHTML = data.letterContent;\r\n            }\r\n            // æ¢å¤ç¤¼ç‰©åˆ—è¡¨\r\n            renderGifts();\r\n        } catch (error) {\r\n            console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);\r\n        }\r\n    }\r\n}\r\n\r\n// ä¿å­˜æ•°æ®åˆ°localStorage\r\nfunction saveToLocalStorage() {\r\n    // èŽ·å–å½“å‰ä¸»é¢˜è‰²\r\n    const currentTheme = document.body.classList.contains('pink') ? 'pink' : \r\n                        document.body.classList.contains('white') ? 'white' : 'blue';\r\n    \r\n    const data = {\r\n        gifts: gifts,\r\n        audioUrl: audioUrl,\r\n        audioName: audioFile ? audioFile.name : null,\r\n        siteTitle: document.getElementById('site-title').value,\r\n        letterTitle: document.getElementById('letter-title').value,\r\n        letterContent: quill ? quill.root.innerHTML : '',\r\n        theme: currentTheme\r\n    };\r\n    localStorage.setItem('giftLetterData', JSON.stringify(data));\r\n    console.log('æ•°æ®å·²ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨');\r\n}\r\n\r\n// ä¿å­˜ç¼–è¾‘çŠ¶æ€åˆ°åŽç«¯\r\nasync function saveEditState() {\r\n    try {\r\n        // èŽ·å–å½“å‰ä¸»é¢˜è‰²\r\n        const currentTheme = document.body.classList.contains('pink') ? 'pink' : \r\n                            document.body.classList.contains('white') ? 'white' : 'blue';\r\n        \r\n        const data = {\r\n            editId: editId,\r\n            gifts: gifts,\r\n            audioUrl: audioUrl,\r\n            audioName: audioFile ? audioFile.name : null,\r\n            siteTitle: document.getElementById('site-title').value,\r\n            letterTitle: document.getElementById('letter-title').value,\r\n            letterContent: quill ? quill.root.innerHTML : '',\r\n            theme: currentTheme\r\n        };\r\n        \r\n        const response = await fetch(`${SERVER_URL}/api/save-edit`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(data)\r\n        });\r\n        \r\n        const result = await response.json();\r\n        if (result.success) {\r\n            editId = result.editId;\r\n            console.log('ç¼–è¾‘çŠ¶æ€å·²ä¿å­˜åˆ°åŽç«¯');\r\n            showSaveStatus('ðŸ’¾ ç¼–è¾‘çŠ¶æ€ä¿å­˜æˆåŠŸå•¦ï½ž');\r\n\r\n            // æ›´æ–°å½“å‰ç¼–è¾‘IDæ˜¾ç¤º\r\n            updateCurrentEditId();\r\n            return result.editId;\r\n        }\r\n    } catch (error) {\r\n        console.error('ä¿å­˜ç¼–è¾‘çŠ¶æ€å¤±è´¥:', error);\r\n    }\r\n    return null;\r\n}\r\n\r\n// æ˜¾ç¤ºä¿å­˜çŠ¶æ€\r\nfunction showSaveStatus(message) {\r\n    // åˆ›å»ºæˆ–èŽ·å–ä¿å­˜çŠ¶æ€å…ƒç´ \r\n    let saveStatus = document.getElementById('save-status');\r\n    if (!saveStatus) {\r\n        saveStatus = document.createElement('div');\r\n        saveStatus.id = 'save-status';\r\n        saveStatus.style.cssText = `\r\n            position: fixed;\r\n            top: 20px;\r\n            right: 20px;\r\n            color: white;\r\n            padding: 12px 20px;\r\n            border-radius: 5px;\r\n            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\r\n            z-index: 1000;\r\n            transition: all 0.3s ease;\r\n            opacity: 0;\r\n            transform: translateY(-20px);\r\n        `;\r\n        document.body.appendChild(saveStatus);\r\n    }\r\n    \r\n    // è®¾ç½®æ¶ˆæ¯å¹¶æ˜¾ç¤º\r\n    saveStatus.textContent = message;\r\n    saveStatus.style.opacity = '1';\r\n    saveStatus.style.transform = 'translateY(0)';\r\n    \r\n    // 3ç§’åŽéšè—\r\n    setTimeout(() => {\r\n        saveStatus.style.opacity = '0';\r\n        saveStatus.style.transform = 'translateY(-20px)';\r\n    }, 3000);\r\n}\r\n\r\n// ä»ŽåŽç«¯åŠ è½½ç¼–è¾‘çŠ¶æ€\r\nasync function loadEditState(loadEditId) {\r\n    try {\r\n        const response = await fetch(`${SERVER_URL}/api/load-edit?editId=${loadEditId}`);\r\n        const result = await response.json();\r\n        if (result.success) {\r\n            const data = result.data;\r\n            editId = data.editId;\r\n            gifts = data.gifts || [];\r\n            audioUrl = data.audioUrl || null;\r\n            \r\n            // æ›´æ–°éŸ³ä¹æ’­æ”¾å™¨UIçŠ¶æ€\r\n            if (audioUrl) {\r\n                // ä¼˜å…ˆä½¿ç”¨ä¿å­˜çš„åŽŸå§‹æ–‡ä»¶å\r\n                const fileName = data.audioName || (() => {\r\n                    // ä»ŽURLä¸­æå–æ–‡ä»¶åä½œä¸ºå¤‡ç”¨\r\n                    const urlParts = audioUrl.split('/');\r\n                    return urlParts[urlParts.length - 1];\r\n                })();\r\n                document.getElementById('music-info').textContent = fileName;\r\n                \r\n                // æ›´æ–°éŸ³ä¹æ–‡ä»¶åæ˜¾ç¤ºå…ƒç´ \r\n                const musicFilenameElement = document.getElementById('music-filename');\r\n                if (musicFilenameElement) {\r\n                    musicFilenameElement.textContent = fileName;\r\n                    musicFilenameElement.style.color = '#666';\r\n                }\r\n                \r\n                // åˆ›å»ºHowlå®žä¾‹\r\n                if (audio) {\r\n                    audio.unload();\r\n                }\r\n                audio = new Howl({\r\n                    src: [audioUrl],\r\n                    loop: true,\r\n                    volume: parseFloat(document.getElementById('volume').value)\r\n                });\r\n            } else {\r\n                document.getElementById('music-info').textContent = 'æœªé€‰æ‹©';\r\n                \r\n                // æ¸…ç©ºéŸ³ä¹æ–‡ä»¶åæ˜¾ç¤ºå…ƒç´ \r\n                const musicFilenameElement = document.getElementById('music-filename');\r\n                if (musicFilenameElement) {\r\n                    musicFilenameElement.textContent = 'æœªé€‰æ‹©';\r\n                    musicFilenameElement.style.color = '#666';\r\n                }\r\n            }\r\n            \r\n            // æ¢å¤ä¸»é¢˜è‰²\r\n            if (data.theme) {\r\n                document.body.classList.remove('pink', 'white', 'blue');\r\n                document.body.classList.add(data.theme);\r\n                \r\n                // æ›´æ–°é¢œè‰²æŒ‰é’®çŠ¶æ€\r\n                const colorBtns = document.querySelectorAll('.color-btn');\r\n                colorBtns.forEach(btn => {\r\n                    if (btn.dataset.color === data.theme) {\r\n                        btn.classList.add('active');\r\n                    } else {\r\n                        btn.classList.remove('active');\r\n                    }\r\n                });\r\n            }\r\n            \r\n            // æ¢å¤æ ‡é¢˜\r\n            if (data.siteTitle) {\r\n                document.getElementById('site-title').value = data.siteTitle;\r\n            }\r\n            if (data.letterTitle) {\r\n                document.getElementById('letter-title').value = data.letterTitle;\r\n            }\r\n            // æ¢å¤ä¹¦ä¿¡å†…å®¹\r\n            if (data.letterContent && quill) {\r\n                quill.root.innerHTML = data.letterContent;\r\n            }\r\n            // æ¢å¤ç¤¼ç‰©åˆ—è¡¨\r\n            renderGifts();\r\n            \r\n            showSaveStatus('ðŸ”„ ç¼–è¾‘çŠ¶æ€æ¢å¤æˆåŠŸå•¦ï½ž');\r\n\r\n            return true;\r\n        }\r\n    } catch (error) {\r\n        console.error('åŠ è½½ç¼–è¾‘çŠ¶æ€å¤±è´¥:', error);\r\n        showSaveStatus('åŠ è½½ç¼–è¾‘çŠ¶æ€å¤±è´¥');\r\n    }\r\n    return false;\r\n}\r\n\r\n// ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨\r\nfunction uploadFileToServer(file) {\r\n    return new Promise((resolve, reject) => {\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n        \r\n        fetch(`${SERVER_URL}/api/upload`, {\r\n            method: 'POST',\r\n            body: formData\r\n        })\r\n        .then(response => {\r\n            if (!response.ok) {\r\n                throw new Error('Upload failed');\r\n            }\r\n            return response.json();\r\n        })\r\n        .then(data => {\r\n            if (data.error) {\r\n                reject(data.error);\r\n            } else {\r\n                resolve(data.url);\r\n            }\r\n        })\r\n        .catch(error => {\r\n            console.error('Upload error:', error);\r\n            reject(error);\r\n        });\r\n    });\r\n}\r\n\r\n// åˆå§‹åŒ–å­—ä½“é€‰æ‹©å™¨\r\nfunction initFontSelector() {\r\n    const fontSelect = document.getElementById('font-select');\r\n    const fontPreview = document.getElementById('font-preview');\r\n    \r\n    if (fontSelect && fontPreview) {\r\n        // å­—ä½“é€‰æ‹©äº‹ä»¶\r\n        fontSelect.addEventListener('change', function() {\r\n            const selectedFont = this.value;\r\n            \r\n            // æ›´æ–°é¢„è§ˆåŒºåŸŸå­—ä½“\r\n            fontPreview.style.fontFamily = selectedFont;\r\n            \r\n            // æ›´æ–°é¡µé¢å…¨å±€å­—ä½“\r\n            document.body.style.fontFamily = selectedFont;\r\n            \r\n            // æ›´æ–°Quillç¼–è¾‘å™¨å­—ä½“\r\n            if (quill) {\r\n                const editor = document.querySelector('.ql-editor');\r\n                if (editor) {\r\n                    editor.style.fontFamily = selectedFont;\r\n                }\r\n            }\r\n            \r\n            // æ›´æ–°ç¤¼ç‰©å¤‡æ³¨å­—ä½“\r\n            const giftNotes = document.querySelectorAll('.gift-note');\r\n            giftNotes.forEach(note => {\r\n                note.style.fontFamily = selectedFont;\r\n            });\r\n            \r\n            console.log('å­—ä½“å·²æ›´æ–°ä¸º:', selectedFont);\r\n        });\r\n        \r\n        // åˆå§‹åŒ–é¢„è§ˆå­—ä½“\r\n        fontPreview.style.fontFamily = fontSelect.value;\r\n    }\r\n}\r\n\r\n// åˆå§‹åŒ–é¡µé¢\r\nfunction initPage() {\r\n    initQuill();\r\n    initColorPicker();\r\n    initGiftManagement();\r\n    initMusicPlayer();\r\n    initGenerateButtons();\r\n    initModals();\r\n    initSortable();\r\n    initFontSelector();\r\n    \r\n    // æ¸…ç†å¯èƒ½å­˜åœ¨çš„äº‹ä»¶ç›‘å¬å™¨\r\n    const giftGrid = document.getElementById('gift-grid');\r\n    giftGrid.innerHTML = giftGrid.innerHTML;\r\n    \r\n    // æ£€æŸ¥URLå‚æ•°ä¸­æ˜¯å¦æœ‰editId\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const urlEditId = urlParams.get('editId');\r\n    if (urlEditId) {\r\n        // å»¶è¿ŸåŠ è½½ç¼–è¾‘çŠ¶æ€ï¼Œç¡®ä¿é¡µé¢å…ƒç´ å·²åˆå§‹åŒ–\r\n        setTimeout(() => {\r\n            loadEditState(urlEditId);\r\n        }, 500);\r\n    } else {\r\n        // ä»ŽlocalStorageåŠ è½½æ•°æ®\r\n        loadFromLocalStorage();\r\n    }\r\n    \r\n    // åˆå§‹åŒ–è¡¨æƒ…æŽ‰è½åŠ¨ç”»\r\n    initEmojiRain();\r\n}\r\n\r\n// åˆå§‹åŒ–å¯Œæ–‡æœ¬ç¼–è¾‘å™¨\r\nfunction initQuill() {\r\n    quill = new Quill('#letter-content', {\r\n        theme: 'snow',\r\n        modules: {\r\n            toolbar: [\r\n                ['bold', 'italic', 'underline'],\r\n                ['blockquote', 'code-block'],\r\n                [{ 'header': 1 }, { 'header': 2 }],\r\n                [{ 'list': 'ordered' }, { 'list': 'bullet' }],\r\n                [{ 'color': [] }, { 'background': [] }],\r\n                [{ 'align': [] }],\r\n                ['clean']\r\n            ]\r\n        },\r\n        placeholder: 'è¯·è¾“å…¥ä¹¦ä¿¡å†…å®¹...',\r\n        // è®¾ç½®é»˜è®¤å­—ä½“\r\n        formats: ['font', 'size', 'bold', 'italic', 'underline', 'strike', 'blockquote', 'code-block', 'header', 'list', 'bullet', 'indent', 'link', 'image', 'color', 'background', 'align'],\r\n        defaultFont: 'Comic Neue'\r\n    });\r\n    \r\n    // ç¡®ä¿ç¼–è¾‘å™¨å†…å®¹ä½¿ç”¨å¯çˆ±å­—ä½“\r\n    quill.on('editor-change', function() {\r\n        const editor = document.querySelector('.ql-editor');\r\n        if (editor) {\r\n            editor.style.fontFamily = \"'Comic Neue', 'Nunito', 'Microsoft YaHei', Arial, sans-serif\";\r\n            editor.style.fontSize = '18px';\r\n        }\r\n    });\r\n}\r\n\r\n// åˆå§‹åŒ–é¢œè‰²é€‰æ‹©å™¨\r\nfunction initColorPicker() {\r\n    const colorBtns = document.querySelectorAll('.color-btn');\r\n    colorBtns.forEach(btn => {\r\n        btn.addEventListener('click', () => {\r\n            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„activeç±»\r\n            colorBtns.forEach(b => b.classList.remove('active'));\r\n            // æ·»åŠ å½“å‰æŒ‰é’®çš„activeç±»\r\n            btn.classList.add('active');\r\n            // æ›´æ”¹bodyçš„é¢œè‰²ç±»\r\n            const color = btn.dataset.color;\r\n            document.body.className = color;\r\n        });\r\n    });\r\n}\r\n\r\n// åˆå§‹åŒ–ç¤¼ç‰©ç®¡ç†\r\nfunction initGiftManagement() {\r\n    // æ·»åŠ ç¤¼ç‰©æŒ‰é’®\r\n    document.getElementById('add-gift').addEventListener('click', () => {\r\n        currentGiftIndex = -1;\r\n        openGiftModal();\r\n    });\r\n}\r\n\r\n// æ‰“å¼€ç¤¼ç‰©ç¼–è¾‘å¼¹çª—\r\nfunction openGiftModal() {\r\n    document.getElementById('gift-modal').style.display = 'block';\r\n    // é‡ç½®æ–‡ä»¶è¾“å…¥\r\n    document.getElementById('gift-file').value = '';\r\n    \r\n    // å¦‚æžœæ˜¯æ·»åŠ æ–°ç¤¼ç‰©ï¼Œæ¸…ç©ºå¤‡æ³¨å¹¶éšè—åª’ä½“é¢„è§ˆ\r\n    if (currentGiftIndex === -1) {\r\n        document.getElementById('gift-note').value = '';\r\n        const currentMediaPreview = document.getElementById('current-media-preview');\r\n        const mediaPreviewContent = document.getElementById('media-preview-content');\r\n        currentMediaPreview.style.display = 'none';\r\n        mediaPreviewContent.innerHTML = '';\r\n    }\r\n}\r\n\r\n// å…³é—­ç¤¼ç‰©ç¼–è¾‘å¼¹çª—\r\nfunction closeGiftModal() {\r\n    document.getElementById('gift-modal').style.display = 'none';\r\n}\r\n\r\n// å¤„ç†æ–‡ä»¶é€‰æ‹©ï¼Œæ·»åŠ è£å‰ªæ­¥éª¤\r\nfunction handleFileSelect(e) {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n    \r\n    currentFile = file;\r\n    \r\n    if (file.type.startsWith('image/')) {\r\n        // å›¾ç‰‡éœ€è¦è£å‰ª\r\n        openCropModal(file);\r\n    } else {\r\n        // è§†é¢‘ç›´æŽ¥ä¸Šä¼ \r\n        saveGiftWithFile(file);\r\n    }\r\n}\r\n\r\n// æ‰“å¼€è£å‰ªå¼¹çª—\r\nfunction openCropModal(file) {\r\n    const reader = new FileReader();\r\n    reader.onload = function(e) {\r\n        const img = document.getElementById('crop-image');\r\n        img.src = e.target.result;\r\n        \r\n        // åˆå§‹åŒ–è£å‰ªå™¨\r\n        if (cropper) {\r\n            cropper.destroy();\r\n        }\r\n        \r\n        cropper = new Cropper(img, {\r\n            aspectRatio: 1, // 1:1æ¯”ä¾‹\r\n            viewMode: 1,\r\n            dragMode: 'move',\r\n            autoCropArea: 0.8, // é»˜è®¤è£å‰ªåŒºåŸŸå¤§å°\r\n            cropBoxMovable: true,\r\n            cropBoxResizable: true\r\n        });\r\n        \r\n        // æ˜¾ç¤ºè£å‰ªå¼¹çª—\r\n        document.getElementById('crop-modal').style.display = 'block';\r\n    };\r\n    reader.readAsDataURL(file);\r\n}\r\n\r\n// å…³é—­è£å‰ªå¼¹çª—\r\nfunction closeCropModal() {\r\n    if (cropper) {\r\n        cropper.destroy();\r\n        cropper = null;\r\n    }\r\n    document.getElementById('crop-modal').style.display = 'none';\r\n    currentFile = null;\r\n}\r\n\r\n// å…¨å±€å˜é‡ï¼šå­˜å‚¨è£å‰ªåŽçš„æ–‡ä»¶\r\nlet croppedFile = null;\r\n// å…¨å±€å˜é‡ï¼šè·Ÿè¸ªæ·»åŠ ç¤¼ç‰©çš„çŠ¶æ€\r\nlet isAddingGift = false;\r\n\r\n// ç¡®è®¤è£å‰ª\r\nasync function confirmCrop() {\r\n    if (!cropper || isAddingGift) return;\r\n    \r\n    try {\r\n        console.log('å¼€å§‹è£å‰ªå›¾ç‰‡');\r\n        // è®¾ç½®æ·»åŠ ç¤¼ç‰©çŠ¶æ€\r\n        isAddingGift = true;\r\n        \r\n        // èŽ·å–è£å‰ªåŽçš„å›¾ç‰‡\r\n        const canvas = cropper.getCroppedCanvas({\r\n            width: 800,\r\n            height: 800,\r\n            fillColor: '#fff',\r\n            imageSmoothingEnabled: true\r\n        });\r\n        \r\n        // å°†canvasè½¬æ¢ä¸ºblob\r\n        canvas.toBlob(function(blob) {\r\n            console.log('è£å‰ªå®Œæˆï¼Œåˆ›å»ºæ–‡ä»¶å¯¹è±¡');\r\n            // åˆ›å»ºæ–°çš„Fileå¯¹è±¡\r\n            croppedFile = new File([blob], currentFile.name, {\r\n                type: currentFile.type,\r\n                lastModified: Date.now()\r\n            });\r\n            \r\n            console.log('å…³é—­è£å‰ªå¼¹çª—');\r\n            // å…³é—­è£å‰ªå¼¹çª—ï¼Œè¿”å›žç¤¼ç‰©ç¼–è¾‘å¼¹çª—\r\n            closeCropModal();\r\n            \r\n            console.log('æ˜¾ç¤ºæç¤ºä¿¡æ¯');\r\n            // æ˜¾ç¤ºæç¤ºä¿¡æ¯ï¼Œè®©ç”¨æˆ·å¡«å†™å¤‡æ³¨\r\n            alert('âœ‚ï¸ è£å‰ªå®Œæˆå•¦ï½žè¯·å¡«å†™ç¤¼ç‰©å¤‡æ³¨åŽç‚¹å‡»ä¿å­˜å“¦ ðŸŽ');\r\n\r\n            \r\n            console.log('è£å‰ªæµç¨‹å®Œæˆï¼Œç¤¼ç‰©ç¼–è¾‘å¼¹çª—åº”è¯¥ä»ç„¶æ‰“å¼€');\r\n            \r\n            // é‡ç½®æ·»åŠ ç¤¼ç‰©çŠ¶æ€\r\n            isAddingGift = false;\r\n        }, currentFile.type);\r\n    } catch (error) {\r\n        console.error('è£å‰ªå¤±è´¥:', error);\r\n        alert('ðŸ˜¢ è£å‰ªå¤±è´¥äº†ï½žè¯·å†è¯•ä¸€æ¬¡å§ ðŸ’ª');\r\n\r\n        // é‡ç½®æ·»åŠ ç¤¼ç‰©çŠ¶æ€\r\n        isAddingGift = false;\r\n    }\r\n}\r\n\r\n// ä¿å­˜ç¤¼ç‰©ï¼ˆå¸¦æ–‡ä»¶å‚æ•°ï¼‰\r\nasync function saveGiftWithFile(file) {\r\n    if (isAddingGift) return;\r\n    \r\n    const noteInput = document.getElementById('gift-note');\r\n    const note = noteInput.value;\r\n    \r\n    try {\r\n        console.log('å¼€å§‹ä¸Šä¼ æ–‡ä»¶:', file.name);\r\n        // è®¾ç½®æ·»åŠ ç¤¼ç‰©çŠ¶æ€\r\n        isAddingGift = true;\r\n        \r\n        // ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨\r\n        const url = await uploadFileToServer(file);\r\n        console.log('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼ŒURL:', url);\r\n        \r\n        let gift;\r\n        if (currentGiftIndex === -1) {\r\n            // æ·»åŠ æ–°ç¤¼ç‰©\r\n            gift = {\r\n                id: Date.now(),\r\n                file: file,\r\n                url: url,\r\n                note: note,\r\n                type: file.type.startsWith('image/') ? 'image' : 'video'\r\n            };\r\n            gifts.push(gift);\r\n            console.log('æ–°ç¤¼ç‰©æ·»åŠ æˆåŠŸ:', gift.id);\r\n        } else {\r\n            // ç¼–è¾‘çŽ°æœ‰ç¤¼ç‰©ï¼Œä¿ç•™åŽŸå§‹ID\r\n            gift = gifts[currentGiftIndex];\r\n            gift.file = file;\r\n            gift.url = url;\r\n            gift.note = note;\r\n            gift.type = file.type.startsWith('image/') ? 'image' : 'video';\r\n            // ä¿ç•™åŽŸå§‹ID\r\n            console.log('ç¤¼ç‰©ç¼–è¾‘æˆåŠŸ:', gift.id);\r\n        }\r\n        \r\n        // é‡æ–°æ¸²æŸ“ç¤¼ç‰©åˆ—è¡¨\r\n        renderGifts();\r\n        // å…³é—­å¼¹çª—\r\n        closeGiftModal();\r\n        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n        saveToLocalStorage();\r\n        // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º\r\n        showSaveStatus('ðŸŽ‰ ç¤¼ç‰©ä¿å­˜æˆåŠŸå•¦ï½ž');\r\n\r\n        console.log('ç¤¼ç‰©ä¿å­˜å®Œæˆ');\r\n    } catch (error) {\r\n        console.error('ä¿å­˜ç¤¼ç‰©å¤±è´¥:', error);\r\n        console.error('é”™è¯¯è¯¦æƒ…:', error.message);\r\n        // æ˜¾ç¤ºæ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯\r\n        alert('ðŸ˜¢ ä¸Šä¼ å¤±è´¥äº†ï½žè¯·å†è¯•ä¸€æ¬¡å§ ðŸ’ª\\n\\né”™è¯¯ä¿¡æ¯: ' + error.message);\r\n\r\n    } finally {\r\n        // é‡ç½®æ·»åŠ ç¤¼ç‰©çŠ¶æ€\r\n        isAddingGift = false;\r\n        // é‡ç½®è£å‰ªæ–‡ä»¶\r\n        croppedFile = null;\r\n    }\r\n}\r\n\r\n// ä¿å­˜ç¤¼ç‰©\r\nfunction saveGift() {\r\n    if (isAddingGift) {\r\n        alert('â° ç¤¼ç‰©æ­£åœ¨æ·»åŠ ä¸­ï¼Œè¯·ç¨å€™å“¦ï½ž ðŸŽ€');\r\n        return;\r\n    }\r\n\r\n    \r\n    const fileInput = document.getElementById('gift-file');\r\n    const noteInput = document.getElementById('gift-note');\r\n    const note = noteInput.value;\r\n    \r\n    console.log('å¼€å§‹ä¿å­˜ç¤¼ç‰©');\r\n    console.log('currentGiftIndex:', currentGiftIndex);\r\n    console.log('fileInput.files.length:', fileInput.files.length);\r\n    console.log('croppedFile:', croppedFile);\r\n    console.log('note:', note);\r\n    \r\n    // å¦‚æžœæ˜¯ç¼–è¾‘çŽ°æœ‰ç¤¼ç‰©ä¸”æ²¡æœ‰é€‰æ‹©æ–°æ–‡ä»¶ï¼Œåªæ›´æ–°å¤‡æ³¨\r\n    if (currentGiftIndex !== -1 && !fileInput.files.length && !croppedFile) {\r\n        console.log('ç¼–è¾‘çŽ°æœ‰ç¤¼ç‰©ï¼Œåªæ›´æ–°å¤‡æ³¨');\r\n        const gift = gifts[currentGiftIndex];\r\n        // æ›´æ–°å¤‡æ³¨\r\n        gift.note = note;\r\n        // é‡æ–°æ¸²æŸ“ç¤¼ç‰©åˆ—è¡¨\r\n        renderGifts();\r\n        // å…³é—­å¼¹çª—\r\n        closeGiftModal();\r\n        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n        saveToLocalStorage();\r\n        // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º\r\n        showSaveStatus('ðŸ“ ç¤¼ç‰©å¤‡æ³¨æ›´æ–°æˆåŠŸå•¦ï½ž');\r\n\r\n        return;\r\n    }\r\n    \r\n    // æ£€æŸ¥æ˜¯å¦æœ‰è£å‰ªåŽçš„æ–‡ä»¶\r\n    if (croppedFile) {\r\n        console.log('ä½¿ç”¨è£å‰ªåŽçš„æ–‡ä»¶ä¿å­˜ç¤¼ç‰©');\r\n        // ä½¿ç”¨è£å‰ªåŽçš„æ–‡ä»¶\r\n        saveGiftWithFile(croppedFile);\r\n    } else if (fileInput.files.length) {\r\n        console.log('å¤„ç†ç”¨æˆ·é€‰æ‹©çš„æ–‡ä»¶');\r\n        // å¤„ç†æ–‡ä»¶é€‰æ‹©\r\n        handleFileSelect({ target: fileInput });\r\n    } else {\r\n        console.log('æ²¡æœ‰é€‰æ‹©æ–‡ä»¶');\r\n        alert('ðŸŽ è¯·å…ˆé€‰æ‹©ç¤¼ç‰©ç´ æå“¦ï½ž');\r\n        return;\r\n\r\n    }\r\n}\r\n\r\n// æ¸²æŸ“ç¤¼ç‰©åˆ—è¡¨\r\nfunction renderGifts() {\r\n    const giftGrid = document.getElementById('gift-grid');\r\n    giftGrid.innerHTML = '';\r\n    \r\n    gifts.forEach((gift, index) => {\r\n        const giftItem = document.createElement('div');\r\n        giftItem.className = 'gift-item';\r\n        \r\n        let mediaElement = '';\r\n        if (gift.type === 'image') {\r\n            mediaElement = `<img src=\"${gift.url}\" alt=\"ç¤¼ç‰©å›¾ç‰‡\" class=\"gift-media\">\r\n            <button onclick=\"previewImage(${index})\" class=\"preview-btn\">é¢„è§ˆ</button>`;\r\n        } else {\r\n            mediaElement = `<video src=\"${gift.url}\" class=\"gift-media\">\r\n            <button onclick=\"this.previousElementSibling.play()\" class=\"preview-btn\">æ’­æ”¾</button>`;\r\n        }\r\n        \r\n        giftItem.innerHTML = `\r\n            <div class=\"gift-media-container\">\r\n                ${mediaElement}\r\n            </div>\r\n            <div class=\"gift-note\">${gift.note || 'æ— å¤‡æ³¨'}</div>\r\n            <div class=\"gift-actions\">\r\n                <button onclick=\"editGift(${index})\" class=\"edit-btn\">ç¼–è¾‘</button>\r\n                <button onclick=\"confirmAndDelete(${index})\" class=\"delete-btn\">åˆ é™¤</button>\r\n            </div>\r\n        `;\r\n        \r\n        giftGrid.appendChild(giftItem);\r\n    });\r\n}\r\n\r\n// æ·»åŠ ä¸€æ¬¡æ€§äº‹ä»¶ç›‘å¬å™¨\r\nfunction addSingleEventListeners() {\r\n    const giftGrid = document.getElementById('gift-grid');\r\n    \r\n    // ç‚¹å‡»åª’ä½“æ–‡ä»¶\r\n    giftGrid.addEventListener('click', function(e) {\r\n        if (e.target.tagName === 'IMG' || e.target.tagName === 'VIDEO') {\r\n            const giftItem = e.target.closest('.gift-item');\r\n            const deleteBtn = giftItem.querySelector('.delete-btn');\r\n            const index = parseInt(deleteBtn.dataset.index);\r\n            if (!isNaN(index)) {\r\n                if (e.target.tagName === 'IMG') {\r\n                    previewImage(index);\r\n                } else if (e.target.tagName === 'VIDEO') {\r\n                    e.target.play();\r\n                }\r\n            }\r\n        }\r\n    });\r\n    \r\n    // ç‚¹å‡»ç¼–è¾‘æŒ‰é’®\r\n    giftGrid.addEventListener('click', function(e) {\r\n        if (e.target.classList.contains('edit-btn')) {\r\n            e.stopPropagation();\r\n            const index = parseInt(e.target.dataset.index);\r\n            if (!isNaN(index)) {\r\n                editGift(index);\r\n            }\r\n        }\r\n    });\r\n    \r\n\r\n}\r\n\r\n// ç›´æŽ¥åˆ é™¤ç¤¼ç‰©\r\nfunction confirmAndDelete(index) {\r\n    console.log('åˆ é™¤æŒ‰é’®è¢«ç‚¹å‡»ï¼Œç´¢å¼•:', index);\r\n    console.log('å½“å‰giftsæ•°ç»„é•¿åº¦:', gifts.length);\r\n    \r\n    // ç›´æŽ¥æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œä¸å¼¹å‡ºç¡®è®¤æ¡†\r\n    if (index >= 0 && index < gifts.length) {\r\n        // æ‰§è¡Œåˆ é™¤\r\n        gifts.splice(index, 1);\r\n        console.log('åˆ é™¤åŽgiftsæ•°ç»„é•¿åº¦:', gifts.length);\r\n        // é‡æ–°æ¸²æŸ“\r\n        renderGifts();\r\n        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n        saveToLocalStorage();\r\n        showSaveStatus('ðŸ—‘ï¸ ç¤¼ç‰©åˆ é™¤æˆåŠŸå•¦ï½ž');\r\n    } else {\r\n        console.error('ç´¢å¼•è¶…å‡ºèŒƒå›´:', index);\r\n        alert('ðŸ˜¢ åˆ é™¤å¤±è´¥äº†ï½žç´¢å¼•è¶…å‡ºèŒƒå›´å•¦ ðŸ’ª');\r\n    }\r\n}\r\n\r\n// ç¼–è¾‘ç¤¼ç‰©\r\nfunction editGift(index) {\r\n    currentGiftIndex = index;\r\n    const gift = gifts[index];\r\n    document.getElementById('gift-note').value = gift.note;\r\n    \r\n    // æ˜¾ç¤ºå½“å‰åª’ä½“æ–‡ä»¶é¢„è§ˆ\r\n    const currentMediaPreview = document.getElementById('current-media-preview');\r\n    const mediaPreviewContent = document.getElementById('media-preview-content');\r\n    \r\n    if (gift && gift.url) {\r\n        // æ˜¾ç¤ºé¢„è§ˆåŒºåŸŸ\r\n        currentMediaPreview.style.display = 'block';\r\n        \r\n        // æ ¹æ®ç¤¼ç‰©ç±»åž‹æ˜¾ç¤ºä¸åŒçš„é¢„è§ˆ\r\n        if (gift.type === 'image') {\r\n            mediaPreviewContent.innerHTML = `<img src=\"${gift.url}\" alt=\"ç¤¼ç‰©å›¾ç‰‡\" style=\"max-width: 100%; max-height: 200px; border-radius: 3px;\">`;\r\n        } else if (gift.type === 'video') {\r\n            mediaPreviewContent.innerHTML = `<video src=\"${gift.url}\" style=\"max-width: 100%; max-height: 200px; border-radius: 3px;\" controls></video>`;\r\n        }\r\n    } else {\r\n        // éšè—é¢„è§ˆåŒºåŸŸ\r\n        currentMediaPreview.style.display = 'none';\r\n        mediaPreviewContent.innerHTML = '';\r\n    }\r\n    \r\n    openGiftModal();\r\n}\r\n\r\n// åˆ é™¤ç¤¼ç‰©\r\nfunction deleteGift(index) {\r\n    console.log('åˆ é™¤æŒ‰é’®è¢«ç‚¹å‡»ï¼Œç´¢å¼•:', index);\r\n    console.log('å½“å‰giftsæ•°ç»„é•¿åº¦:', gifts.length);\r\n    console.log('å½“å‰giftsæ•°ç»„:', gifts);\r\n    \r\n    // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†\r\n    const confirmed = confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªç¤¼ç‰©å—ï¼Ÿåˆ é™¤åŽæ— æ³•æ¢å¤ã€‚');\r\n    console.log('ç”¨æˆ·ç¡®è®¤:', confirmed);\r\n    \r\n    if (confirmed) {\r\n        console.log('æ‰§è¡Œåˆ é™¤æ“ä½œï¼Œç´¢å¼•:', index);\r\n        if (index >= 0 && index < gifts.length) {\r\n            // æ‰§è¡Œåˆ é™¤\r\n            gifts.splice(index, 1);\r\n            console.log('åˆ é™¤åŽgiftsæ•°ç»„é•¿åº¦:', gifts.length);\r\n            // é‡æ–°æ¸²æŸ“\r\n            renderGifts();\r\n            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n            saveToLocalStorage();\r\n            showSaveStatus('ç¤¼ç‰©åˆ é™¤æˆåŠŸ');\r\n        } else {\r\n            console.error('ç´¢å¼•è¶…å‡ºèŒƒå›´:', index);\r\n            alert('åˆ é™¤å¤±è´¥ï¼šç´¢å¼•è¶…å‡ºèŒƒå›´');\r\n        }\r\n    } else {\r\n        console.log('ç”¨æˆ·å–æ¶ˆåˆ é™¤æ“ä½œ');\r\n    }\r\n}\r\n\r\n// é¢„è§ˆå›¾ç‰‡\r\nfunction previewImage(index) {\r\n    const gift = gifts[index];\r\n    if (gift.type === 'image') {\r\n        // è¿™é‡Œå¯ä»¥å®žçŽ°å›¾ç‰‡é¢„è§ˆåŠŸèƒ½\r\n        console.log('é¢„è§ˆå›¾ç‰‡:', gift.url);\r\n    }\r\n}\r\n\r\n\r\n\r\n// åˆå§‹åŒ–ç”ŸæˆæŒ‰é’®\r\nfunction initGenerateButtons() {\r\n    // é¢„è§ˆæŒ‰é’®\r\n    document.getElementById('preview-btn').addEventListener('click', function() {\r\n        previewShowPage();\r\n    });\r\n    \r\n    // ç”ŸæˆæŒ‰é’®\r\n    document.getElementById('generate-btn').addEventListener('click', function() {\r\n        generateShowPackage();\r\n    });\r\n}\r\n\r\n// é¢„è§ˆå±•ç¤ºé¡µ\r\nfunction previewShowPage() {\r\n    const previewContent = document.getElementById('preview-content');\r\n    const siteTitle = document.getElementById('site-title').value;\r\n    const letterTitle = document.getElementById('letter-title').value;\r\n    const letterContent = quill.root.innerHTML;\r\n    \r\n    // æž„å»ºé¢„è§ˆå†…å®¹\r\n    let html = `\r\n        <h1>${siteTitle}</h1>\r\n        <h2>ç¤¼ç‰©</h2>\r\n        <div class=\"gift-grid\">\r\n    `;\r\n    \r\n    gifts.forEach(gift => {\r\n        let mediaElement = '';\r\n        if (gift.type === 'image') {\r\n            mediaElement = `<img src=\"${gift.url}\" alt=\"ç¤¼ç‰©å›¾ç‰‡\" class=\"gift-media\">`;\r\n        } else {\r\n            mediaElement = `<video src=\"${gift.url}\" class=\"gift-media\"></video>`;\r\n        }\r\n        \r\n        html += `\r\n            <div class=\"gift-item\">\r\n                <div class=\"gift-media-container\">\r\n                    ${mediaElement}\r\n                </div>\r\n                <div class=\"gift-note\">${gift.note || 'æ— å¤‡æ³¨'}</div>\r\n            </div>\r\n        `;\r\n    });\r\n    \r\n    html += `\r\n        </div>\r\n        <h2>${letterTitle}</h2>\r\n        <div class=\"letter-content\">${letterContent}</div>\r\n        <div class=\"music-player\">\r\n            <span>èƒŒæ™¯éŸ³ä¹: ${audioFile ? audioFile.name : 'æœªé€‰æ‹©'}</span>\r\n        </div>\r\n    `;\r\n    \r\n    previewContent.innerHTML = html;\r\n    document.getElementById('preview-modal').style.display = 'block';\r\n}\r\n\r\n// ç”Ÿæˆå±•ç¤ºåŒ…\r\nasync function generateShowPackage() {\r\n    try {\r\n        // ä¿å­˜ç¼–è¾‘çŠ¶æ€\r\n        await saveEditState();\r\n        \r\n        const siteTitle = document.getElementById('site-title').value || 'æˆ‘çš„ç¤¼ç‰©';\r\n        const letterTitle = document.getElementById('letter-title').value || 'ç”Ÿæ—¥ç¥ç¦';\r\n        const letterContent = quill.root.innerHTML;\r\n        \r\n        // èŽ·å–å½“å‰ä¸»é¢˜è‰²\r\n        const currentTheme = document.body.classList.contains('pink') ? 'pink' : \r\n                            document.body.classList.contains('white') ? 'white' : 'blue';\r\n        \r\n        // å‡†å¤‡å±•ç¤ºæ•°æ®\r\n        const showData = {\r\n            siteTitle: siteTitle,\r\n            letterTitle: letterTitle,\r\n            letterContent: letterContent,\r\n            gifts: gifts.map(gift => ({\r\n                id: gift.id,\r\n                url: gift.url,\r\n                note: gift.note,\r\n                type: gift.type\r\n            })),\r\n            audioUrl: audioUrl,\r\n            audioName: audioFile ? audioFile.name : null,\r\n            theme: currentTheme\r\n        };\r\n        \r\n        // ä¿å­˜åˆ°åŽç«¯å¹¶èŽ·å–åˆ†äº«é“¾æŽ¥\r\n        const response = await fetch(`${SERVER_URL}/api/save-show`, {\r\n            method: 'POST',\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body: JSON.stringify(showData)\r\n        });\r\n        \r\n        const result = await response.json();\r\n        \r\n        if (result.success) {\r\n            // æ˜¾ç¤ºç”ŸæˆæˆåŠŸä¿¡æ¯å’Œåˆ†äº«é“¾æŽ¥\r\n            let editLink = '';\r\n            if (editId) {\r\n                editLink = `<p style=\"margin-top: 10px;\">ç¼–è¾‘é“¾æŽ¥ï¼ˆç”¨äºŽåŽç»­ä¿®æ”¹ï¼‰ï¼š</p>\r\n                <p style=\"background-color: #f0f0f0; padding: 15px; border-radius: 5px; word-break: break-all;\">\r\n                    ${SERVER_URL}/edit.html?editId=${editId}\r\n                </p>`;\r\n            }\r\n            \r\n            document.getElementById('generate-info').innerHTML = `\r\n                <p style=\"color: green;\">ç”ŸæˆæˆåŠŸï¼è¯·å°†ä»¥ä¸‹é“¾æŽ¥åˆ†äº«ç»™å¯¹æ–¹ï¼š</p>\r\n                <p style=\"background-color: #f0f0f0; padding: 15px; border-radius: 5px; word-break: break-all;\">\r\n                    ${result.shareUrl}\r\n                </p>\r\n                ${editLink}\r\n                <p style=\"color: blue;\">æ³¨æ„ï¼šæ­¤é“¾æŽ¥æ°¸ä¹…æœ‰æ•ˆï¼Œè¯·å¦¥å–„ä¿ç®¡ã€‚</p>\r\n            `;\r\n            \r\n            // å¤åˆ¶é“¾æŽ¥åˆ°å‰ªè´´æ¿\r\n            try {\r\n                await navigator.clipboard.writeText(result.shareUrl);\r\n                document.getElementById('generate-info').innerHTML += `\r\n                    <p style=\"color: green; font-size: 14px;\">âœ… åˆ†äº«é“¾æŽ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</p>\r\n                `;\r\n            } catch (clipboardError) {\r\n                console.log('æ— æ³•å¤åˆ¶åˆ°å‰ªè´´æ¿:', clipboardError);\r\n            }\r\n        } else {\r\n            document.getElementById('generate-info').innerHTML = `\r\n                <p style=\"color: red;\">ç”Ÿæˆå¤±è´¥: ${result.error}</p>\r\n            `;\r\n        }\r\n    } catch (error) {\r\n        console.error('ç”Ÿæˆåˆ†äº«é“¾æŽ¥å¤±è´¥:', error);\r\n        document.getElementById('generate-info').innerHTML = `\r\n            <p style=\"color: red;\">ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚</p>\r\n        `;\r\n    }\r\n}\r\n\r\n// æ›´æ–°å½“å‰ç¼–è¾‘IDæ˜¾ç¤º\r\nfunction updateCurrentEditId() {\r\n    const currentEditIdElement = document.getElementById('current-edit-id');\r\n    if (currentEditIdElement) {\r\n        if (editId) {\r\n            currentEditIdElement.textContent = `å½“å‰ç¼–è¾‘ID: ${editId} (å¯ç”¨äºŽåŽç»­æ¢å¤ç¼–è¾‘)`;\r\n        } else {\r\n            currentEditIdElement.textContent = 'æœªä¿å­˜ç¼–è¾‘çŠ¶æ€';\r\n        }\r\n    }\r\n}\r\n\r\n// åˆå§‹åŒ–å¼¹çª—\r\nfunction initModals() {\r\n    // å…³é—­ç¤¼ç‰©å¼¹çª—\r\n    document.querySelector('#gift-modal .close').addEventListener('click', closeGiftModal);\r\n    \r\n    // å…³é—­é¢„è§ˆå¼¹çª—\r\n    document.querySelector('#preview-modal .close').addEventListener('click', function() {\r\n        document.getElementById('preview-modal').style.display = 'none';\r\n    });\r\n    \r\n    // å…³é—­è£å‰ªå¼¹çª—\r\n    document.querySelector('#crop-modal .close').addEventListener('click', closeCropModal);\r\n    document.getElementById('cancel-crop').addEventListener('click', closeCropModal);\r\n    document.getElementById('confirm-crop').addEventListener('click', confirmCrop);\r\n    \r\n    // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­\r\n    window.addEventListener('click', function(e) {\r\n        const giftModal = document.getElementById('gift-modal');\r\n        const previewModal = document.getElementById('preview-modal');\r\n        const cropModal = document.getElementById('crop-modal');\r\n        \r\n        if (e.target === giftModal) {\r\n            closeGiftModal();\r\n        }\r\n        \r\n        if (e.target === previewModal) {\r\n            previewModal.style.display = 'none';\r\n        }\r\n        \r\n        if (e.target === cropModal) {\r\n            closeCropModal();\r\n        }\r\n    });\r\n    \r\n    // ä¿å­˜ç¤¼ç‰©æŒ‰é’®\r\n    document.getElementById('save-gift').addEventListener('click', saveGift);\r\n    \r\n    // æ–‡ä»¶é€‰æ‹©äº‹ä»¶\r\n    document.getElementById('gift-file').addEventListener('change', handleFileSelect);\r\n    \r\n    // æ ‡é¢˜å’Œå†…å®¹å˜åŒ–æ—¶è‡ªåŠ¨ä¿å­˜\r\n    document.getElementById('site-title').addEventListener('input', saveToLocalStorage);\r\n    document.getElementById('letter-title').addEventListener('input', saveToLocalStorage);\r\n    \r\n    // å»¶è¿Ÿæ·»åŠ Quillç›‘å¬ï¼Œç¡®ä¿Quillå·²åˆå§‹åŒ–\r\n    setTimeout(() => {\r\n        if (quill) {\r\n            quill.on('text-change', saveToLocalStorage);\r\n            console.log('å·²æ·»åŠ Quillæ–‡æœ¬å˜åŒ–ç›‘å¬');\r\n        }\r\n    }, 500);\r\n    \r\n    // æ¢å¤ç¼–è¾‘çŠ¶æ€æŒ‰é’®\r\n    const loadEditBtn = document.getElementById('load-edit-btn');\r\n    if (loadEditBtn) {\r\n        loadEditBtn.addEventListener('click', function() {\r\n            const editIdInput = document.getElementById('edit-id-input');\r\n            const inputEditId = editIdInput.value.trim();\r\n            if (inputEditId) {\r\n                loadEditState(inputEditId);\r\n            } else {\r\n                alert('è¯·è¾“å…¥ç¼–è¾‘ID');\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n// åˆå§‹åŒ–æ‹–æ‹½æŽ’åº\r\nfunction initSortable() {\r\n    const giftGrid = document.getElementById('gift-grid');\r\n    new Sortable(giftGrid, {\r\n        animation: 150,\r\n        ghostClass: 'sortable-ghost', // æ·»åŠ æ‹–æ‹½æ—¶çš„å¹½çµå…ƒç´ æ ·å¼\r\n        chosenClass: 'sortable-chosen', // æ·»åŠ é€‰ä¸­å…ƒç´ çš„æ ·å¼\r\n        dragClass: 'sortable-drag', // æ·»åŠ æ‹–æ‹½å…ƒç´ çš„æ ·å¼\r\n        onStart: function(evt) {\r\n            // æŽ’åºå¼€å§‹æ—¶çš„è§†è§‰åé¦ˆ\r\n            const draggedElement = evt.item;\r\n            draggedElement.style.opacity = '0.5';\r\n        },\r\n        onEnd: function(evt) {\r\n            // æŽ’åºç»“æŸæ—¶çš„è§†è§‰åé¦ˆ\r\n            const draggedElement = evt.item;\r\n            draggedElement.style.opacity = '1';\r\n            \r\n            // é‡æ–°æŽ’åºç¤¼ç‰©æ•°ç»„\r\n            const draggedGift = gifts.splice(evt.oldIndex, 1)[0];\r\n            gifts.splice(evt.newIndex, 0, draggedGift);\r\n            // é‡æ–°æ¸²æŸ“ç¤¼ç‰©åˆ—è¡¨ï¼Œç¡®ä¿åˆ é™¤æŒ‰é’®çš„indexå€¼ä¸Žå½“å‰giftsæ•°ç»„é¡ºåºä¸€è‡´\r\n            renderGifts();\r\n            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n            saveToLocalStorage();\r\n            showSaveStatus('ç¤¼ç‰©é¡ºåºå·²æ›´æ–°');\r\n        }\r\n    });\r\n}\r\n\r\n// åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨\r\nfunction initMusicPlayer() {\r\n    // éŸ³ä¹ä¸Šä¼ æŒ‰é’®ç‚¹å‡»äº‹ä»¶\r\n    document.getElementById('music-upload-btn').addEventListener('click', function() {\r\n        document.getElementById('music-upload').click();\r\n    });\r\n    \r\n    // éŸ³ä¹ä¸Šä¼ \r\n    document.getElementById('music-upload').addEventListener('change', async function(e) {\r\n        const file = e.target.files[0];\r\n        if (file && file.type.startsWith('audio/')) {\r\n            try {\r\n                // å…ˆæ›´æ–°éŸ³ä¹ä¿¡æ¯ï¼Œæ˜¾ç¤ºæ­£åœ¨ä¸Šä¼ \r\n                document.getElementById('music-info').textContent = 'ä¸Šä¼ ä¸­...';\r\n                \r\n                // ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨\r\n                const url = await uploadFileToServer(file);\r\n                \r\n                // æ›¿æ¢éŸ³ä¹\r\n                if (audio) {\r\n                    audio.unload();\r\n                    showSaveStatus('ðŸŽµ éŸ³ä¹å·²æ›¿æ¢ï½ž');\r\n                } else {\r\n                    showSaveStatus('ðŸŽµ éŸ³ä¹ä¿å­˜æˆåŠŸå•¦ï½ž');\r\n                }\r\n                \r\n                audioFile = file;\r\n                audioUrl = url;\r\n                document.getElementById('music-info').textContent = file.name;\r\n                \r\n                // æ›´æ–°éŸ³ä¹æ–‡ä»¶åæ˜¾ç¤ºå…ƒç´ \r\n                const musicFilenameElement = document.getElementById('music-filename');\r\n                if (musicFilenameElement) {\r\n                    musicFilenameElement.textContent = file.name;\r\n                    musicFilenameElement.style.color = '#666';\r\n                }\r\n                \r\n                // åˆ›å»ºæ–°çš„Howlå®žä¾‹\r\n                audio = new Howl({\r\n                    src: [url],\r\n                    loop: true,\r\n                    volume: parseFloat(document.getElementById('volume').value)\r\n                });\r\n                \r\n                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n                saveToLocalStorage();\r\n\r\n            } catch (error) {\r\n                console.error('ä¸Šä¼ éŸ³ä¹å¤±è´¥:', error);\r\n                document.getElementById('music-info').textContent = 'ä¸Šä¼ å¤±è´¥';\r\n                alert('ðŸ˜¢ éŸ³ä¹ä¸Šä¼ å¤±è´¥äº†ï½žè¯·å†è¯•ä¸€æ¬¡å§ ðŸ’ª');\r\n\r\n            }\r\n        } else if (file) {\r\n            alert('ðŸŽµ è¯·é€‰æ‹©éŸ³é¢‘æ–‡ä»¶å“¦ï½ž');\r\n        }\r\n    });\r\n    \r\n    // æ¸…é™¤éŸ³ä¹\r\n    document.getElementById('clear-music').addEventListener('click', function() {\r\n        if (audio) {\r\n            audio.unload();\r\n            audio = null;\r\n        }\r\n        audioFile = null;\r\n        audioUrl = null;\r\n        document.getElementById('music-info').textContent = 'æœªé€‰æ‹©';\r\n        document.getElementById('play-btn').textContent = 'æ’­æ”¾';\r\n        \r\n        // æ¸…ç©ºéŸ³ä¹æ–‡ä»¶åæ˜¾ç¤ºå…ƒç´ \r\n        const musicFilenameElement = document.getElementById('music-filename');\r\n        if (musicFilenameElement) {\r\n            musicFilenameElement.textContent = 'æœªé€‰æ‹©';\r\n            musicFilenameElement.style.color = '#666';\r\n        }\r\n        \r\n        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨\r\n        saveToLocalStorage();\r\n        showSaveStatus('ðŸŽµ éŸ³ä¹å·²æ¸…é™¤ï½ž');\r\n    });\r\n    \r\n    // æ’­æ”¾/æš‚åœæŒ‰é’®\r\n    document.getElementById('play-btn').addEventListener('click', function() {\r\n        if (audio) {\r\n            if (audio.playing()) {\r\n                audio.pause();\r\n                this.textContent = 'æ’­æ”¾';\r\n            } else {\r\n                audio.play();\r\n                this.textContent = 'æš‚åœ';\r\n            }\r\n        } else {\r\n            showSaveStatus('ðŸŽµ è¯·å…ˆé€‰æ‹©éŸ³ä¹å“¦ï½ž');\r\n        }\r\n    });\r\n    \r\n    // éŸ³é‡æŽ§åˆ¶\r\n    document.getElementById('volume').addEventListener('input', function() {\r\n        const volume = parseFloat(this.value);\r\n        if (audio) {\r\n            audio.volume(volume);\r\n        }\r\n    });\r\n}\r\n\r\n// åˆå§‹åŒ–è¡¨æƒ…æŽ‰è½åŠ¨ç”»\r\nfunction initEmojiRain() {\r\n    const letterContent = document.querySelector('.letter-content');\r\n    \r\n    // å¯çˆ±è¡¨æƒ…é›†åˆ\r\n    const emojis = ['ðŸ˜Š', 'ðŸ¥°', 'ðŸ¤©', 'ðŸŒŸ', 'ðŸŽ€', 'ðŸŽ‰', 'âœ¨', 'ðŸ’–', 'ðŸŒ¸', 'ðŸ¦‹', 'ðŸŒˆ', 'ðŸ’', 'ðŸ’—', 'ðŸ’“', 'ðŸ’ž'];\r\n    \r\n    // å½“ç”¨æˆ·è¾“å…¥æ—¶è§¦å‘è¡¨æƒ…æŽ‰è½\r\n    if (quill) {\r\n        quill.on('text-change', function() {\r\n            // éšæœºå†³å®šæ˜¯å¦è§¦å‘ï¼Œé¿å…è¿‡äºŽé¢‘ç¹\r\n            if (Math.random() > 0.7) {\r\n                createEmojiRain(letterContent, emojis);\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n// åˆ›å»ºè¡¨æƒ…æŽ‰è½æ•ˆæžœ\r\nfunction createEmojiRain(container, emojis) {\r\n    // é™åˆ¶åŒæ—¶æ˜¾ç¤ºçš„è¡¨æƒ…æ•°é‡\r\n    const existingEmojis = container.querySelectorAll('.emoji-rain');\r\n    if (existingEmojis.length > 10) return;\r\n    \r\n    // åˆ›å»ºå¤šä¸ªè¡¨æƒ…\r\n    const emojiCount = Math.floor(Math.random() * 3) + 1;\r\n    \r\n    for (let i = 0; i < emojiCount; i++) {\r\n        const emoji = document.createElement('div');\r\n        emoji.className = 'emoji-rain';\r\n        emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];\r\n        \r\n        // éšæœºä½ç½®å’Œæ ·å¼\r\n        const left = Math.random() * 100;\r\n        const fontSize = Math.random() * 20 + 20;\r\n        const duration = Math.random() * 3 + 2;\r\n        \r\n        emoji.style.position = 'absolute';\r\n        emoji.style.left = `${left}%`;\r\n        emoji.style.top = '-30px';\r\n        emoji.style.fontSize = `${fontSize}px`;\r\n        emoji.style.pointerEvents = 'none';\r\n        emoji.style.zIndex = '10';\r\n        emoji.style.animation = `emojiFall ${duration}s ease-in-out forwards`;\r\n        \r\n        container.appendChild(emoji);\r\n        \r\n        // åŠ¨ç”»ç»“æŸåŽç§»é™¤\r\n        setTimeout(() => {\r\n            emoji.remove();\r\n        }, duration * 1000);\r\n    }\r\n}\r\n\r\n// é¡µé¢åŠ è½½å®ŒæˆåŽåˆå§‹åŒ–\r\nwindow.onload = initPage;\r\n"],"names":[],"version":3,"file":"edit.49903994.js.map","sourceRoot":"/__parcel_source_root/"}